--ROLLUP function
--in addition to the regular aggregation results we expected from the GROUP BY clasue, the ROLLUP extension produces group subtotals and 
a grand total
--The TRUNC (date) function returns date with the time portion of the day truncated to the unit specified by the format.
SELECT TRUNC(s.sales_date,'mon') AS sales_month, p.product_name, SUM(sales_amount) AS sales_amount
FROM sales s, product p
WHERE s.product_id = p.product_id
GROUP BY ROLLUP(TRUNC(s.sales_date,'mon'), p.product_name)
ORDER BY TRUNC(s.sales_date,'mon'), p.product_name;

--CUBE function
--in addition to the subtotals generated by the ROLLUP extension, the CUBE extension will generate subtotals for all combinations of the
dimensions specified.
--the result below will provide the subtotal of each month, product category and the grand total of the month
SELECT TRUNC(s.sales_date,'mon') AS sales_month, p.product_name, SUM(sales_amount) AS sales_amount
FROM sales s, product p
WHERE s.product_id = p.product_id
GROUP BY CUBE(TRUNC(s.sales_date,'mon'), p.product_name)
ORDER BY TRUNC(s.sales_date,'mon'), p.product_name;

